<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33108845-1']);
  _gaq.push(['_setDomainName', 'opencv.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction into Android Development &mdash; OpenCV 2.4.13.7 documentation</title>
    <link rel="stylesheet" href="../../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '2.4.13.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <link rel="top" title="OpenCV 2.4.13.7 documentation" href="../../../../index.html" />
    <link rel="up" title="Introduction to OpenCV" href="../table_of_content_introduction/table_of_content_introduction.html" />
    <link rel="next" title="OpenCV4Android SDK" href="O4A_SDK.html" />
    <link rel="prev" title="Introduction to OpenCV Development with Clojure" href="../clojure_dev_intro/clojure_dev_intro.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="O4A_SDK.html" title="OpenCV4Android SDK"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../clojure_dev_intro/clojure_dev_intro.html" title="Introduction to OpenCV Development with Clojure"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../../index.html">OpenCV 2.4.13.7 documentation</a> &raquo;</li>
          <li><a href="../../tutorials.html" >OpenCV Tutorials</a> &raquo;</li>
          <li><a href="../table_of_content_introduction/table_of_content_introduction.html" accesskey="U">Introduction to OpenCV</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
  
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="introduction-into-android-development">
<span id="android-dev-intro"></span><h1>Introduction into Android Development<a class="headerlink" href="#introduction-into-android-development" title="Permalink to this headline">¶</a></h1>
<p>This guide was designed to help you in learning Android development basics and setting up your
working environment quickly. It was written with Windows 7 in mind, though it would work with Linux
(Ubuntu), Mac OS X and any other OS supported by Android SDK.</p>
<p>If you encounter any error after thoroughly following these steps, feel free to contact us via
<a class="reference external" href="https://groups.google.com/group/android-opencv/">OpenCV4Android</a> discussion group or
OpenCV <a class="reference external" href="http://answers.opencv.org">Q&amp;A forum</a>. We&#8217;ll do our best to help you out.</p>
<div class="section" id="preface">
<h2>Preface<a class="headerlink" href="#preface" title="Permalink to this headline">¶</a></h2>
<p>Android is a Linux-based, open source mobile operating system developed by Open Handset Alliance
led by Google. See the <a class="reference external" href="http://www.android.com/about/">Android home site</a> for general details.</p>
<p>Development for Android significantly differs from development for other platforms.
So before starting programming for Android we recommend you make sure that you are familiar with the
following key topis:</p>
<ol class="arabic simple">
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Java_(programming_language)">Java</a> programming language that is
the primary development technology for Android OS. Also, you can find
<a class="reference external" href="http://docs.oracle.com/javase/">Oracle docs on Java</a> useful.</li>
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Java_Native_Interface">Java Native Interface (JNI)</a> that is a
technology of running native code in Java virtual machine. Also, you can find
<a class="reference external" href="http://docs.oracle.com/javase/7/docs/technotes/guides/jni/">Oracle docs on JNI</a> useful.</li>
<li><a class="reference external" href="http://developer.android.com/training/basics/activity-lifecycle/starting.html">Android Activity</a>
and its lifecycle, that is an essential Android API class.</li>
<li>OpenCV development will certainly require some knowlege of the
<a class="reference external" href="http://developer.android.com/guide/topics/media/camera.html">Android Camera</a> specifics.</li>
</ol>
</div>
<div class="section" id="quick-environment-setup-for-android-development">
<h2>Quick environment setup for Android development<a class="headerlink" href="#quick-environment-setup-for-android-development" title="Permalink to this headline">¶</a></h2>
<p>If you are making a clean environment install, then you can try <a class="reference external" href="https://developer.nvidia.com/tegra-android-development-pack">Tegra Android Development Pack</a>
(<strong>TADP</strong>) released by <strong>NVIDIA</strong>.</p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Starting the <em>version 2.0</em> the TADP package includes <em>OpenCV for Tegra</em> SDK that is a regular <em>OpenCV4Android SDK</em> extended with Tegra-specific stuff.</p>
</div>
</div></blockquote>
<p>When unpacked, TADP will cover all of the environment setup automatically and you can skip the rest of the guide.</p>
<p>If you are a beginner in Android development then we also recommend you to start with TADP.</p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><em>NVIDIA</em>&#8216;s Tegra Android Development Pack includes some special features for
<a class="reference external" href="http://www.nvidia.com/object/tegra-3-processor.html"><em>NVIDIA</em>’s Tegra platform</a> but its use is not limited to <em>Tegra</em> devices only.</p>
</div>
</div></blockquote>
<ul>
<li><p class="first">You need at least <em>1.6 Gb</em> free disk space for the install.</p>
</li>
<li><p class="first">TADP will download Android SDK platforms and Android NDK from Google&#8217;s server, so Internet
connection is required for the installation.</p>
</li>
<li><p class="first">TADP may ask you to flash your development kit at the end of installation process. Just skip
this step if you have no <a class="reference external" href="http://developer.nvidia.com/mobile/tegra-hardware-sales-inquiries">Tegra Development Kit</a>.</p>
</li>
<li><p class="first">(<code class="docutils literal"><span class="pre">UNIX</span></code>) TADP will ask you for <em>root</em> in the middle of installation, so you need to be a
member of <em>sudo</em> group.</p>
<blockquote>
<div></div></blockquote>
</li>
</ul>
</div>
<div class="section" id="manual-environment-setup-for-android-development">
<span id="android-environment-setup-lite"></span><h2>Manual environment setup for Android development<a class="headerlink" href="#manual-environment-setup-for-android-development" title="Permalink to this headline">¶</a></h2>
<div class="section" id="development-in-java">
<h3>Development in Java<a class="headerlink" href="#development-in-java" title="Permalink to this headline">¶</a></h3>
<p>You need the following software to be installed in order to develop for Android in Java:</p>
<ol class="arabic">
<li><p class="first"><strong>Sun JDK 6</strong> (Sun JDK 7 is also possible)</p>
<p>Visit <a class="reference external" href="http://www.oracle.com/technetwork/java/javase/downloads/">Java SE Downloads page</a>
and download an installer for your OS.</p>
<p>Here is a detailed <abbr title="Java Development Kit">JDK</abbr>
<a class="reference external" href="http://source.android.com/source/initializing.html#installing-the-jdk">installation guide</a>
for Ubuntu and Mac OS (only JDK sections are applicable for OpenCV)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>OpenJDK is not suitable for Android development, since Android SDK supports only Sun JDK.
If you use Ubuntu, after installation of Sun JDK you should run the following command to set
Sun java environment:</p>
<div class="last highlight-bash"><div class="highlight"><pre>sudo update-java-alternatives --set java-6-sun
</pre></div>
</div>
</div>
</li>
<li><p class="first"><strong>Android SDK</strong></p>
<p>Get the latest <code class="docutils literal"><span class="pre">Android</span> <span class="pre">SDK</span></code> from <a class="reference external" href="http://developer.android.com/sdk/index.html">http://developer.android.com/sdk/index.html</a></p>
<p>Here is Google&#8217;s <a class="reference external" href="http://developer.android.com/sdk/installing.html">install guide</a> for the SDK.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can choose downloading <strong>ADT Bundle package</strong> that in addition to Android SDK Tools includes
Eclipse + ADT + NDK/CDT plugins, Android Platform-tools, the latest Android platform and the latest
Android system image for the emulator - this is the best choice for those who is setting up Android
development environment the first time!</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you are running x64 version of Ubuntu Linux, then you need ia32 shared libraries
for use on amd64 and ia64 systems to be installed. You can install them with the
following command:</p>
<div class="highlight-bash"><div class="highlight"><pre>sudo apt-get install ia32-libs
</pre></div>
</div>
<p>For Red Hat based systems the following command might be helpful:</p>
<div class="last highlight-bash"><div class="highlight"><pre>sudo yum install libXtst.i386
</pre></div>
</div>
</div>
</li>
<li><p class="first"><strong>Android SDK components</strong></p>
<p>You need the following SDK components to be installed:</p>
<ul>
<li><p class="first"><em>Android SDK Tools, revision 20</em> or newer.</p>
<p>Older revisions should also work, but they are not recommended.</p>
</li>
<li><p class="first"><em>SDK Platform Android 3.0</em> (<code class="docutils literal"><span class="pre">API</span> <span class="pre">11</span></code>).</p>
<p>The minimal platform supported by OpenCV Java API is <strong>Android 2.2</strong> (<code class="docutils literal"><span class="pre">API</span> <span class="pre">8</span></code>). This is also
the minimum API Level required for the provided samples to run.
See the <code class="docutils literal"><span class="pre">&lt;uses-sdk</span> <span class="pre">android:minSdkVersion=&quot;8&quot;/&gt;</span></code> tag in their <strong>AndroidManifest.xml</strong> files.
But for successful compilation the <strong>target</strong> platform should be set to Android 3.0 (API 11) or higher. It will not prevent them from running on  Android 2.2.</p>
<img alt="Android SDK Manager" class="align-center" src="../../../../_images/android_sdk_and_avd_manager.png" />
<p>See <a class="reference external" href="http://developer.android.com/sdk/installing/adding-packages.html">Adding Platforms and Packages</a>
for help with installing/updating SDK components.</p>
</li>
</ul>
</li>
<li><p class="first"><strong>Eclipse IDE</strong></p>
<p>Check the <a class="reference external" href="http://developer.android.com/sdk/requirements.html">Android SDK System Requirements</a>
document for a list of Eclipse versions that are compatible with the Android SDK.
For OpenCV 2.4.x we recommend <strong>Eclipse 3.7 (Indigo)</strong> or <strong>Eclipse 4.2 (Juno)</strong>. They work well for
OpenCV under both Windows and Linux.</p>
<p>If you have no Eclipse installed, you can get it from the <a class="reference external" href="http://www.eclipse.org/downloads/">official site</a>.</p>
</li>
<li><p class="first"><strong>ADT plugin for Eclipse</strong></p>
<p>These instructions are copied from
<a class="reference external" href="http://developer.android.com/sdk/installing/installing-adt.html">Android Developers site</a>,
check it out in case of any ADT-related problem.</p>
<p>Assuming that you have Eclipse IDE installed, as described above, follow these steps to download
and install the ADT plugin:</p>
<ol class="arabic">
<li><p class="first">Start Eclipse, then select <span class="menuselection">Help ‣ Install New Software...</span></p>
</li>
<li><p class="first">Click <span class="guilabel">Add</span> (in the top-right corner).</p>
</li>
<li><p class="first">In the <span class="guilabel">Add Repository</span> dialog that appears, enter &#8220;ADT Plugin&#8221; for the Name and the
following URL for the Location:</p>
<p><a class="reference external" href="https://dl-ssl.google.com/android/eclipse/">https://dl-ssl.google.com/android/eclipse/</a></p>
</li>
<li><p class="first">Click <span class="guilabel">OK</span></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you have trouble acquiring the plugin, try using &#8220;http&#8221; in the Location URL,
instead of &#8220;https&#8221; (https is preferred for security reasons).</p>
</div>
</li>
<li><p class="first">In the <span class="guilabel">Available Software</span> dialog, select the checkbox next to
<span class="guilabel">Developer Tools</span> and click <span class="guilabel">Next</span>.</p>
</li>
<li><p class="first">In the next window, you&#8217;ll see a list of the tools to be downloaded. Click <span class="guilabel">Next</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you also plan to develop native C++ code with Android NDK don&#8217;t forget to
enable <cite>NDK Plugins</cite> installations as well.</p>
</div>
<img alt="ADT installation" class="align-center" src="../../../../_images/eclipse_inst_adt.png" />
</li>
<li><p class="first">Read and accept the license agreements, then click <span class="guilabel">Finish</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you get a security warning saying that the authenticity or validity of the software
can&#8217;t be established, click <span class="guilabel">OK</span>.</p>
</div>
</li>
<li><p class="first">When the installation completes, restart Eclipse.</p>
</li>
</ol>
</li>
</ol>
</div>
<div class="section" id="native-development-in-c">
<h3>Native development in C++<a class="headerlink" href="#native-development-in-c" title="Permalink to this headline">¶</a></h3>
<p>You need the following software to be installed in order to develop for Android in C++:</p>
<ol class="arabic">
<li><p class="first"><strong>Android NDK</strong></p>
<p>To compile C++ code for Android platform you need <code class="docutils literal"><span class="pre">Android</span> <span class="pre">Native</span> <span class="pre">Development</span> <span class="pre">Kit</span></code> (<em>NDK</em>).</p>
<p>You can get the latest version of NDK from the
<a class="reference external" href="http://developer.android.com/tools/sdk/ndk/index.html">download page</a>.
To install Android NDK just extract the archive to some folder on your computer. Here are
<a class="reference external" href="http://developer.android.com/tools/sdk/ndk/index.html#Installing">installation instructions</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Before start you can read official Android NDK documentation which is in the Android
NDK archive, in the folder <code class="file docutils literal"><span class="pre">docs/</span></code>.
The main article about using Android NDK build system is in the <code class="file docutils literal"><span class="pre">ANDROID-MK.html</span></code> file.
Some additional information you can find in
the <code class="file docutils literal"><span class="pre">APPLICATION-MK.html</span></code>, <code class="file docutils literal"><span class="pre">NDK-BUILD.html</span></code> files,
and <code class="file docutils literal"><span class="pre">CPU-ARM-NEON.html</span></code>, <code class="file docutils literal"><span class="pre">CPLUSPLUS-SUPPORT.html</span></code>, <code class="file docutils literal"><span class="pre">PREBUILTS.html</span></code>.</p>
</div>
</li>
<li><p class="first"><strong>CDT plugin for Eclipse</strong></p>
<p>If you selected for installation the <code class="docutils literal"><span class="pre">NDK</span> <span class="pre">plugins</span></code> component of Eclipse ADT plugin (see the picture above) your Eclipse IDE
should already have <code class="docutils literal"><span class="pre">CDT</span> <span class="pre">plugin</span></code> (that means <code class="docutils literal"><span class="pre">C/C++</span> <span class="pre">Development</span> <span class="pre">Tooling</span></code>).
There are several possible ways to integrate compilation of C++ code by Android NDK into Eclipse
compilation process. We recommend the approach based on Eclipse
<abbr title="C/C++ Development Tooling">CDT</abbr> Builder.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="android-application-structure">
<h2>Android application structure<a class="headerlink" href="#android-application-structure" title="Permalink to this headline">¶</a></h2>
<p>Usually source code of an Android application has the following structure:</p>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">root</span> <span class="pre">folder</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">project/</span></code><ul>
<li><code class="file docutils literal"><span class="pre">jni/</span></code></li>
<li><code class="file docutils literal"><span class="pre">libs/</span></code></li>
<li><code class="file docutils literal"><span class="pre">res/</span></code></li>
<li><code class="file docutils literal"><span class="pre">src/</span></code></li>
<li><code class="file docutils literal"><span class="pre">AndroidManifest.xml</span></code></li>
<li><code class="file docutils literal"><span class="pre">project.properties</span></code></li>
<li><code class="file docutils literal"><span class="pre">...</span> <span class="pre">other</span> <span class="pre">files</span> <span class="pre">...</span></code></li>
</ul>
</li>
</ul>
<p>Where:</p>
<ul>
<li><p class="first">the <code class="file docutils literal"><span class="pre">src</span></code> folder contains Java code of the application,</p>
</li>
<li><p class="first">the <code class="file docutils literal"><span class="pre">res</span></code> folder contains resources of the application (images, xml files describing UI
layout, etc),</p>
</li>
<li><p class="first">the <code class="file docutils literal"><span class="pre">libs</span></code> folder will contain native libraries after a successful build,</p>
</li>
<li><p class="first">and the <code class="file docutils literal"><span class="pre">jni</span></code> folder contains C/C++ application source code and NDK&#8217;s build scripts
<code class="file docutils literal"><span class="pre">Android.mk</span></code> and <code class="file docutils literal"><span class="pre">Application.mk</span></code> producing the native libraries,</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">AndroidManifest.xml</span></code> file presents essential information about application to the Android
system (name of the Application, name of main application&#8217;s package, components of the
application, required permissions, etc).</p>
<p>It can be created using Eclipse wizard or <strong class="command">android</strong> tool from Android SDK.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">project.properties</span></code> is a text file containing information about target Android platform
and other build details. This file is generated by Eclipse or can be created with
<strong class="command">android</strong> tool included in Android SDK.</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Both <code class="file docutils literal"><span class="pre">AndroidManifest.xml</span></code> and <code class="file docutils literal"><span class="pre">project.properties</span></code> files are required to
compile the C++ part of the application, since Android NDK build system relies on them.
If any of these files does not exist, compile the Java part of the project before the C++ part.</p>
</div>
</div>
<div class="section" id="android-mk-and-application-mk-scripts">
<h2><code class="file docutils literal"><span class="pre">Android.mk</span></code> and <code class="file docutils literal"><span class="pre">Application.mk</span></code> scripts<a class="headerlink" href="#android-mk-and-application-mk-scripts" title="Permalink to this headline">¶</a></h2>
<p>The script <code class="file docutils literal"><span class="pre">Android.mk</span></code> usually has the following structure:</p>
<div class="highlight-make"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre>LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)
LOCAL_MODULE    := &lt;module_name&gt;
LOCAL_SRC_FILES := &lt;list of .c and .cpp project files&gt;
&lt;some variable name&gt; := &lt;some variable value&gt;
...
&lt;some variable name&gt; := &lt;some variable value&gt;

include $(BUILD_SHARED_LIBRARY)
</pre></div>
</td></tr></table></div>
<p>This is the minimal file <code class="file docutils literal"><span class="pre">Android.mk</span></code>, which builds C++ source code of an Android application.
Note that the first two lines and the last line are mandatory for any <code class="file docutils literal"><span class="pre">Android.mk</span></code>.</p>
<p>Usually the file <code class="file docutils literal"><span class="pre">Application.mk</span></code> is optional, but in case of project using OpenCV, when STL
and exceptions are used in C++, it also should be created. Example of the file <code class="file docutils literal"><span class="pre">Application.mk</span></code>:</p>
<div class="highlight-make"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="nv">APP_STL</span> <span class="o">:=</span> gnustl_static
<span class="nv">APP_CPPFLAGS</span> <span class="o">:=</span> -frtti -fexceptions
<span class="nv">APP_ABI</span> <span class="o">:=</span> all
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We recommend setting <code class="docutils literal"><span class="pre">APP_ABI</span> <span class="pre">:=</span> <span class="pre">all</span></code> for all targets. If you want to specify the
target explicitly, use <code class="docutils literal"><span class="pre">armeabi</span></code> for ARMv5/ARMv6, <code class="docutils literal"><span class="pre">armeabi-v7a</span></code> for ARMv7, <code class="docutils literal"><span class="pre">x86</span></code>
for Intel Atom or <code class="docutils literal"><span class="pre">mips</span></code> for MIPS.</p>
</div>
</div>
<div class="section" id="building-application-native-part-from-command-line">
<span id="ndk-build-cli"></span><h2>Building application native part from command line<a class="headerlink" href="#building-application-native-part-from-command-line" title="Permalink to this headline">¶</a></h2>
<p>Here is the standard way to compile C++ part of an Android application:</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">We strongly reccomend using <code class="docutils literal"><span class="pre">cmd.exe</span></code> (standard Windows console) instead of Cygwin on
<strong>Windows</strong>. Use the latter if only you&#8217;re absolutely sure about, what you&#8217;re doing. Cygwin
is not really supported and we are unlikely to help you in case you encounter some
problems with it. So, use it only if you&#8217;re capable of handling the consequences yourself.</p>
</div>
<ol class="arabic">
<li><p class="first">Open console and go to the root folder of an Android application</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">cd</span> &lt;root folder of the project&gt;/
</pre></div>
</div>
</li>
<li><p class="first">Run the following command</p>
<div class="highlight-bash"><div class="highlight"><pre>&lt;path_where_NDK_is_placed&gt;/ndk-build
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">On Windows we recommend to use <code class="docutils literal"><span class="pre">ndk-build.cmd</span></code> in standard Windows console (<code class="docutils literal"><span class="pre">cmd.exe</span></code>)
rather than the similar <code class="docutils literal"><span class="pre">bash</span></code> script in <code class="docutils literal"><span class="pre">Cygwin</span></code> shell.</p>
</div>
<img alt="NDK build" class="align-center" src="../../../../_images/ndk_build.png" />
</li>
<li><p class="first">After executing this command the C++ part of the source code is compiled.</p>
</li>
</ol>
<p>After that the Java part of the application can be (re)compiled (using either <em>Eclipse</em> or <em>Ant</em> build tool).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Some parameters can be set for the <strong class="command">ndk-build</strong>:</p>
<p><strong>Example 1</strong>: Verbose compilation</p>
<div class="highlight-bash"><div class="highlight"><pre>&lt;path_where_NDK_is_placed&gt;/ndk-build <span class="nv">V</span><span class="o">=</span>1
</pre></div>
</div>
<p><strong>Example 2</strong>: Rebuild all</p>
<div class="last highlight-bash"><div class="highlight"><pre>&lt;path_where_NDK_is_placed&gt;/ndk-build -B
</pre></div>
</div>
</div>
</div>
<div class="section" id="building-application-native-part-from-eclipse-cdt-builder">
<span id="cdt-builder"></span><h2>Building application native part from <em>Eclipse</em> (CDT Builder)<a class="headerlink" href="#building-application-native-part-from-eclipse-cdt-builder" title="Permalink to this headline">¶</a></h2>
<p>There are several possible ways to integrate compilation of native C++ code by Android NDK into
Eclipse build process. We recommend the approach based on Eclipse
<abbr title="C/C++ Development Tooling">CDT</abbr> Builder.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">OpenCV for Android package since version 2.4.2 contains sample projects
pre-configured CDT Builders. For your own projects follow the steps below.</p>
</div>
<ol class="arabic">
<li><p class="first">Define the <code class="docutils literal"><span class="pre">NDKROOT</span></code> environment variable containing the path to Android NDK in your system
(e.g. <code class="docutils literal"><span class="pre">&quot;X:\\Apps\\android-ndk-r8&quot;</span></code> or <code class="docutils literal"><span class="pre">&quot;/opt/android-ndk-r8&quot;</span></code>).</p>
<p><strong>On Windows</strong> an environment variable can be set via
<span class="guilabel">My Computer -&gt; Properties -&gt; Advanced -&gt; Environment variables</span>.
On Windows 7 it&#8217;s also possible to use <a class="reference external" href="http://ss64.com/nt/setx.html">setx</a> command in a console session.</p>
<p><strong>On Linux</strong> and <strong>MacOS</strong> an environment variable can be set via appending a
<code class="docutils literal"><span class="pre">&quot;export</span> <span class="pre">VAR_NAME=VAR_VALUE&quot;</span></code> line to the <code class="file docutils literal"><span class="pre">&quot;~/.bashrc&quot;</span></code> file and logging off and then on.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It&#8217;s also possible to define the <code class="docutils literal"><span class="pre">NDKROOT</span></code> environment variable within Eclipse IDE,
but it should be done for every new workspace you create. If you prefer this option better than setting system
environment variable, open Eclipse menu <span class="guilabel">Window -&gt; Preferences -&gt; C/C++ -&gt; Build -&gt; Environment</span>,
press the <span class="guilabel">Add...</span> button and set variable name to <code class="docutils literal"><span class="pre">NDKROOT</span></code> and value to local Android NDK path.</p>
</div>
</li>
<li><p class="first">After that you need to <strong>restart Eclipse</strong> to apply the changes.</p>
</li>
<li><p class="first">Open Eclipse and load the Android app project to configure.</p>
</li>
<li><p class="first">Add C/C++ Nature to the project via Eclipse menu <span class="guilabel">New -&gt; Other -&gt; C/C++ -&gt; Convert to a C/C++ Project</span>.</p>
<img alt="Configure CDT" class="align-center" src="../../../../_images/eclipse_cdt_cfg1.png" />
<p>And:</p>
<img alt="Configure CDT" class="align-center" src="../../../../_images/eclipse_cdt_cfg2.png" />
</li>
<li><p class="first">Select the project(s) to convert. Specify &#8220;Project type&#8221; = <code class="docutils literal"><span class="pre">Makefile</span> <span class="pre">project</span></code>,
&#8220;Toolchains&#8221; = <code class="docutils literal"><span class="pre">Other</span> <span class="pre">Toolchain</span></code>.</p>
<blockquote>
<div><img alt="Configure CDT" class="align-center" src="../../../../_images/eclipse_cdt_cfg3.png" />
</div></blockquote>
</li>
<li><p class="first">Open <span class="guilabel">Project Properties -&gt; C/C++ Build</span>, uncheck <code class="docutils literal"><span class="pre">Use</span> <span class="pre">default</span> <span class="pre">build</span> <span class="pre">command</span></code>,
replace &#8220;Build command&#8221; text from <code class="docutils literal"><span class="pre">&quot;make&quot;</span></code> to</p>
<p><code class="docutils literal"><span class="pre">&quot;${NDKROOT}/ndk-build.cmd&quot;</span></code> on Windows,</p>
<p><code class="docutils literal"><span class="pre">&quot;${NDKROOT}/ndk-build&quot;</span></code> on Linux and MacOS.</p>
<img alt="Configure CDT" class="align-center" src="../../../../_images/eclipse_cdt_cfg4.png" />
</li>
<li><p class="first">Go to <span class="guilabel">Behaviour</span>  tab and change &#8220;Workbench build type&#8221; section like shown below:</p>
<img alt="Configure CDT" class="align-center" src="../../../../_images/eclipse_cdt_cfg5.png" />
</li>
<li><p class="first">Press <span class="guilabel">OK</span>  and make sure the <code class="docutils literal"><span class="pre">ndk-build</span></code> is successfully invoked when building the project.</p>
<img alt="Configure CDT" class="align-center" src="../../../../_images/eclipse_cdt_cfg6.png" />
</li>
<li><p class="first">If you open your C++ source file in Eclipse editor, you&#8217;ll see syntax error notifications.
They are not real errors, but additional CDT configuring is required.</p>
<img alt="Configure CDT" class="align-center" src="../../../../_images/eclipse_cdt_cfg7.png" />
</li>
<li><p class="first">Open <span class="guilabel">Project Properties -&gt; C/C++ General -&gt; Paths and Symbols</span> and add the following
<strong>Include</strong> paths for <strong>C++</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre># for NDK r8 and prior:
${NDKROOT}/platforms/android-9/arch-arm/usr/include
${NDKROOT}/sources/cxx-stl/gnu-libstdc++/include
${NDKROOT}/sources/cxx-stl/gnu-libstdc++/libs/armeabi-v7a/include
${ProjDirPath}/../../sdk/native/jni/include
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre># for NDK r8b and later:
${NDKROOT}/platforms/android-9/arch-arm/usr/include
${NDKROOT}/sources/cxx-stl/gnu-libstdc++/4.6/include
${NDKROOT}/sources/cxx-stl/gnu-libstdc++/4.6/libs/armeabi-v7a/include
${ProjDirPath}/../../sdk/native/jni/include
</pre></div>
</div>
<p>The last path should be changed to the correct absolute or relative path to OpenCV4Android SDK location.</p>
<p>This should clear the syntax error notifications in Eclipse C++ editor.</p>
<img alt="Configure CDT" class="align-center" src="../../../../_images/eclipse_cdt_cfg8.png" />
</li>
</ol>
</div>
<div class="section" id="debugging-and-testing">
<h2>Debugging and Testing<a class="headerlink" href="#debugging-and-testing" title="Permalink to this headline">¶</a></h2>
<p>In this section we will give you some easy-to-follow instructions on how to set up an emulator or
hardware device for testing and debugging an Android project.</p>
<div class="section" id="avd">
<h3>AVD<a class="headerlink" href="#avd" title="Permalink to this headline">¶</a></h3>
<p>AVD (<em>Android Virtual Device</em>) is not probably the most convenient way to test an OpenCV-dependent
application, but sure the most uncomplicated one to configure.</p>
<ol class="arabic">
<li><p class="first">Assuming you already have <em>Android SDK</em> and <em>Eclipse IDE</em> installed, in Eclipse go
<span class="guilabel">Window -&gt; AVD Manager</span>.</p>
</li>
<li><p class="first">Press the <span class="guilabel">New</span> button in <span class="guilabel">AVD Manager</span> window.</p>
</li>
<li><p class="first"><span class="guilabel">Create new Android Virtual Device</span> window will let you select some properties for your
new device, like target API level, size of SD-card and other.</p>
<img alt="Configure builders" class="align-center" src="../../../../_images/AVD_create.png" />
</li>
<li><p class="first">When you click the <span class="guilabel">Create AVD</span> button, your new AVD will be availible in <span class="guilabel">AVD Manager</span>.</p>
</li>
<li><p class="first">Press <span class="guilabel">Start</span> to launch the device. Be aware that any AVD (a.k.a. Emulator) is usually
much slower than a hardware Android device, so it may take up to several minutes to start.</p>
</li>
<li><p class="first">Go <span class="guilabel">Run -&gt; Run/Debug</span>  in Eclipse IDE to run your application in regular or debugging
mode. <span class="guilabel">Device Chooser</span> will let you choose among the running devices or to start a new one.</p>
</li>
</ol>
</div>
<div class="section" id="hardware-device">
<h3>Hardware Device<a class="headerlink" href="#hardware-device" title="Permalink to this headline">¶</a></h3>
<p>If you have an Android device, you can use it to test and debug your applications. This way is more
authentic, though a little bit harder to set up. You need to make some actions for Windows and Linux
operating systems to be able to work with Android devices. No extra actions are required for Mac OS.
See detailed information on configuring hardware devices in subsections below.</p>
<p>You may also consult the official
<a class="reference external" href="http://developer.android.com/tools/device.html">Android Developers site instructions</a>
for more information.</p>
<div class="section" id="windows-host-computer">
<h4>Windows host computer<a class="headerlink" href="#windows-host-computer" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Enable USB debugging on the Android device (via <span class="guilabel">Settings</span> menu).</p>
</li>
<li><p class="first">Attach the Android device to your PC with a USB cable.</p>
</li>
<li><p class="first">Go to <span class="guilabel">Start Menu</span> and <strong>right-click</strong> on <span class="guilabel">Computer</span>.
Select <span class="guilabel">Manage</span> in the context menu. You may be asked for Administrative permissions.</p>
</li>
<li><p class="first">Select <span class="guilabel">Device Manager</span> in the left pane and find an unknown device in the list.
You may try unplugging it and then plugging back in order to check whether it&#8217;s your exact
equipment appears in the list.</p>
<img alt="Unknown device" class="align-center" src="../../../../_images/usb_device_connect_01.png" />
</li>
<li><p class="first">Try your luck installing <cite>Google USB drivers</cite> without any modifications: <strong>right-click</strong> on the
unknown device, select <span class="guilabel">Properties</span> menu item &#8211;&gt; <span class="guilabel">Details</span> tab &#8211;&gt;
<span class="guilabel">Update Driver</span> button.</p>
<img alt="Device properties" class="align-center" src="../../../../_images/usb_device_connect_05.png" />
</li>
<li><p class="first">Select <span class="guilabel">Browse computer for driver software</span>.</p>
<img alt="Browse for driver" class="align-center" src="../../../../_images/usb_device_connect_06.png" />
</li>
<li><p class="first">Specify the path to <code class="file docutils literal"><span class="pre">&lt;Android</span> <span class="pre">SDK</span> <span class="pre">folder&gt;/extras/google/usb_driver/</span></code> folder.</p>
<img alt="Browse for driver" class="align-center" src="../../../../_images/usb_device_connect_07.png" />
</li>
<li><p class="first">If you get the prompt to install unverified drivers and report about success - you&#8217;ve finished
with USB driver installation.</p>
<img alt="Install prompt" class="align-center" src="../../../../_images/usb_device_connect_08.png" />
<dl class="docutils">
<dt>` `</dt>
<dd></dd>
</dl>
<img alt="Installed OK" class="align-center" src="../../../../_images/usb_device_connect_09.png" />
</li>
<li><p class="first">Otherwise (getting the failure like shown below) follow the next steps.</p>
<img alt="No driver" class="align-center" src="../../../../_images/usb_device_connect_12.png" />
</li>
<li><p class="first">Again <strong>right-click</strong> on the unknown device, select <span class="guilabel">Properties &#8211;&gt; Details &#8211;&gt; Hardware Ids</span>
and copy the line like <code class="docutils literal"><span class="pre">USB\VID_XXXX&amp;PID_XXXX&amp;MI_XX</span></code>.</p>
<img alt="Device properties details" class="align-center" src="../../../../_images/usb_device_connect_02.png" />
</li>
<li><p class="first">Now open file <code class="file docutils literal"><span class="pre">&lt;Android</span> <span class="pre">SDK</span> <span class="pre">folder&gt;/extras/google/usb_driver/android_winusb.inf</span></code>. Select
either <code class="docutils literal"><span class="pre">Google.NTx86</span></code> or <code class="docutils literal"><span class="pre">Google.NTamd64</span></code> section depending on your host system architecture.</p>
<img alt="&quot;android_winusb.inf&quot;" class="align-center" src="../../../../_images/usb_device_connect_03.png" />
</li>
<li><p class="first">There should be a record like existing ones for your device and you need to add one manually.</p>
<img alt="&quot;android_winusb.inf&quot;" class="align-center" src="../../../../_images/usb_device_connect_04.png" />
</li>
<li><p class="first">Save the <code class="file docutils literal"><span class="pre">android_winusb.inf</span></code> file and try to install the USB driver again.</p>
<img alt="Device properties" class="align-center" src="../../../../_images/usb_device_connect_05.png" />
<p>` `</p>
<img alt="Browse for driver" class="align-center" src="../../../../_images/usb_device_connect_06.png" />
<p>` `</p>
<img alt="Browse for driver" class="align-center" src="../../../../_images/usb_device_connect_07.png" />
</li>
<li><p class="first">This time installation should go successfully.</p>
<img alt="Install prompt" class="align-center" src="../../../../_images/usb_device_connect_08.png" />
<p>` `</p>
<img alt="Installed OK" class="align-center" src="../../../../_images/usb_device_connect_09.png" />
</li>
<li><p class="first">And an unknown device is now recognized as an Android phone.</p>
<img alt="&quot;Known&quot; device" class="align-center" src="../../../../_images/usb_device_connect_10.png" />
</li>
<li><p class="first">Successful device USB connection can be verified in console via <code class="docutils literal"><span class="pre">adb</span> <span class="pre">devices</span></code> command.</p>
<img alt="&quot;adb devices&quot;" class="align-center" src="../../../../_images/usb_device_connect_11.png" />
</li>
<li><p class="first">Now, in Eclipse go <span class="guilabel">Run -&gt; Run/Debug</span> to run your application in regular or debugging
mode. <span class="guilabel">Device Chooser</span> will let you choose among the devices.</p>
</li>
</ol>
</div>
<div class="section" id="linux-host-computer">
<h4>Linux host computer<a class="headerlink" href="#linux-host-computer" title="Permalink to this headline">¶</a></h4>
<p>By default Linux doesn&#8217;t recognize Android devices, but it&#8217;s easy to fix this issue. On Ubuntu Linux
you have to create a new <strong>/etc/udev/rules.d/51-android.rules</strong> configuration file that contains
information about your Android device. You may find some Vendor ID&#8217;s
<a class="reference external" href="http://developer.android.com/tools/device.html#VendorIds">here</a> or execute <strong class="command">lsusb</strong>
command to view VendorID of plugged Android device. Here is an example of such file for LG device:</p>
<div class="highlight-guess"><div class="highlight"><pre>SUBSYSTEM==&quot;usb&quot;, ATTR{idVendor}==&quot;1004&quot;,  MODE=&quot;0666&quot;, GROUP=&quot;plugdev&quot;
</pre></div>
</div>
<p>Then restart your adb server (even better to restart the system), plug in your Android device and
execute <strong class="command">adb devices</strong> command. You will see the list of attached devices:</p>
<img alt="List of attached devices" class="align-center" src="../../../../_images/usb_device_connect_ubuntu.png" />
</div>
<div class="section" id="mac-os-host-computer">
<h4>Mac OS host computer<a class="headerlink" href="#mac-os-host-computer" title="Permalink to this headline">¶</a></h4>
<p>No actions are required, just connect your device via USB and run <code class="docutils literal"><span class="pre">adb</span> <span class="pre">devices</span></code> to check connection.</p>
</div>
</div>
</div>
<div class="section" id="what-s-next">
<h2>What&#8217;s next<a class="headerlink" href="#what-s-next" title="Permalink to this headline">¶</a></h2>
<p>Now, when you have your development environment set up and configured, you may want to proceed to
installing OpenCV4Android SDK. You can learn how to do that in a separate <a class="reference internal" href="O4A_SDK.html#o4a-sdk"><span>OpenCV4Android SDK</span></a> tutorial.</p>
</div>
</div>


          </div>
          <div class="feedback">
              <h2>Help and Feedback</h2>
              You did not find what you were looking for?
              <ul>
                  
                  
                  
                  <li>Ask a question on the <a href="http://answers.opencv.org">Q&A forum</a>.</li>
                  <li>If you think something is missing or wrong in the documentation,
                  please file a <a href="http://code.opencv.org">bug report</a>.</li>
              </ul>
          </div>
        </div>
      </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/opencv-logo-white.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
      <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
      </p>
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction into Android Development</a><ul>
<li><a class="reference internal" href="#preface">Preface</a></li>
<li><a class="reference internal" href="#quick-environment-setup-for-android-development">Quick environment setup for Android development</a></li>
<li><a class="reference internal" href="#manual-environment-setup-for-android-development">Manual environment setup for Android development</a><ul>
<li><a class="reference internal" href="#development-in-java">Development in Java</a></li>
<li><a class="reference internal" href="#native-development-in-c">Native development in C++</a></li>
</ul>
</li>
<li><a class="reference internal" href="#android-application-structure">Android application structure</a></li>
<li><a class="reference internal" href="#android-mk-and-application-mk-scripts"><code class="file docutils literal"><span class="pre">Android.mk</span></code> and <code class="file docutils literal"><span class="pre">Application.mk</span></code> scripts</a></li>
<li><a class="reference internal" href="#building-application-native-part-from-command-line">Building application native part from command line</a></li>
<li><a class="reference internal" href="#building-application-native-part-from-eclipse-cdt-builder">Building application native part from <em>Eclipse</em> (CDT Builder)</a></li>
<li><a class="reference internal" href="#debugging-and-testing">Debugging and Testing</a><ul>
<li><a class="reference internal" href="#avd">AVD</a></li>
<li><a class="reference internal" href="#hardware-device">Hardware Device</a><ul>
<li><a class="reference internal" href="#windows-host-computer">Windows host computer</a></li>
<li><a class="reference internal" href="#linux-host-computer">Linux host computer</a></li>
<li><a class="reference internal" href="#mac-os-host-computer">Mac OS host computer</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#what-s-next">What&#8217;s next</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../clojure_dev_intro/clojure_dev_intro.html"
                        title="previous chapter">Introduction to OpenCV Development with Clojure</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="O4A_SDK.html"
                        title="next chapter">OpenCV4Android SDK</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../../_sources/doc/tutorials/introduction/android_binary_package/android_dev_intro.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="O4A_SDK.html" title="OpenCV4Android SDK"
             >next</a> |</li>
        <li class="right" >
          <a href="../clojure_dev_intro/clojure_dev_intro.html" title="Introduction to OpenCV Development with Clojure"
             >previous</a> |</li>
        <li><a href="../../../../index.html">OpenCV 2.4.13.7 documentation</a> &raquo;</li>
          <li><a href="../../tutorials.html" >OpenCV Tutorials</a> &raquo;</li>
          <li><a href="../table_of_content_introduction/table_of_content_introduction.html" >Introduction to OpenCV</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011-2014, opencv dev team.
      Last updated on Jul 12, 2018.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.6.
    </div>
  </body>
</html>