<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33108845-1']);
  _gaq.push(['_setDomainName', 'opencv.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction to Support Vector Machines &mdash; OpenCV 2.4.13.7 documentation</title>
    <link rel="stylesheet" href="../../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '2.4.13.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <link rel="top" title="OpenCV 2.4.13.7 documentation" href="../../../../index.html" />
    <link rel="up" title="ml module. Machine Learning" href="../table_of_content_ml/table_of_content_ml.html" />
    <link rel="next" title="Support Vector Machines for Non-Linearly Separable Data" href="../non_linear_svms/non_linear_svms.html" />
    <link rel="prev" title="ml module. Machine Learning" href="../table_of_content_ml/table_of_content_ml.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../non_linear_svms/non_linear_svms.html" title="Support Vector Machines for Non-Linearly Separable Data"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../table_of_content_ml/table_of_content_ml.html" title="ml module. Machine Learning"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../../index.html">OpenCV 2.4.13.7 documentation</a> &raquo;</li>
          <li><a href="../../tutorials.html" >OpenCV Tutorials</a> &raquo;</li>
          <li><a href="../table_of_content_ml/table_of_content_ml.html" accesskey="U"><em>ml</em> module. Machine Learning</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
  
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="introduction-to-support-vector-machines">
<span id="introductiontosvms"></span><h1>Introduction to Support Vector Machines<a class="headerlink" href="#introduction-to-support-vector-machines" title="Permalink to this headline">¶</a></h1>
<div class="section" id="goal">
<h2>Goal<a class="headerlink" href="#goal" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial you will learn how to:</p>
<div class="enumeratevisibleitemswithsquare container">
<ul class="simple">
<li>Use the OpenCV functions <a class="reference external" href="http://docs.opencv.org/modules/ml/doc/support_vector_machines.html#cvsvm-train">CvSVM::train</a> to build a classifier based on SVMs and <a class="reference external" href="http://docs.opencv.org/modules/ml/doc/support_vector_machines.html#cvsvm-predict">CvSVM::predict</a> to test its performance.</li>
</ul>
</div>
</div>
<div class="section" id="what-is-a-svm">
<h2>What is a SVM?<a class="headerlink" href="#what-is-a-svm" title="Permalink to this headline">¶</a></h2>
<p>A Support Vector Machine (SVM) is a discriminative classifier formally defined by a separating hyperplane. In other words, given labeled training data (<em>supervised learning</em>), the algorithm outputs an optimal hyperplane which categorizes new examples.</p>
<p>In which sense is the hyperplane obtained optimal? Let&#8217;s consider the following
simple problem:</p>
<blockquote>
<div>For a linearly separable set of 2D-points which belong to one of two classes, find a separating straight line.</div></blockquote>
<img alt="A seperation example" class="align-center" src="../../../../_images/separating-lines.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In this example we deal with lines and points in the Cartesian plane instead of hyperplanes and vectors in a high dimensional space. This is a simplification of the problem.It is important to understand that this is done only because our intuition is better built from examples that are easy to imagine. However, the same concepts apply to tasks where the examples to classify lie in a space whose dimension is higher than two.</p>
</div>
<p>In the above picture you can see that there exists multiple lines that offer a solution to the problem. Is any of them better than the others? We can intuitively define a criterion to estimate the worth of the lines:</p>
<blockquote>
<div>A line is bad if it passes too close to the points because it will be noise sensitive and it will not generalize correctly. Therefore, our goal should be to find the line passing as far as possible from all points.</div></blockquote>
<p>Then, the operation of the SVM algorithm is based on finding the hyperplane that gives the largest minimum distance to the training examples. Twice, this distance receives the important name of <strong>margin</strong> within SVM&#8217;s theory. Therefore, the optimal separating hyperplane <em>maximizes</em> the margin of the training data.</p>
<img alt="The Optimal hyperplane" class="align-center" src="../../../../_images/optimal-hyperplane.png" />
</div>
<div class="section" id="how-is-the-optimal-hyperplane-computed">
<h2>How is the optimal hyperplane computed?<a class="headerlink" href="#how-is-the-optimal-hyperplane-computed" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s introduce the notation used to define formally a hyperplane:</p>
<div class="math">
<p><img src="../../../../_images/math/a5e013dff4ddcb681fcf652fd59e0300bbce2dd6.png" alt="f(x) = \beta_{0} + \beta^{T} x,"/></p>
</div><p>where <img class="math" src="../../../../_images/math/247b5ce2e487d3610db5ce3e3d8cc882c38ab8db.png" alt="\beta"/> is known as the <em>weight vector</em> and <img class="math" src="../../../../_images/math/14399e7612a4ec9fbdf2368f565afb3cdffc083d.png" alt="\beta_{0}"/> as the <em>bias</em>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">A more in depth description of this and hyperplanes you can find in the section 4.5 (<em>Seperating Hyperplanes</em>) of the book: <em>Elements of Statistical Learning</em> by T. Hastie, R. Tibshirani and J. H. Friedman.</p>
</div>
<p>The optimal hyperplane can be represented in an infinite number of different ways by scaling of <img class="math" src="../../../../_images/math/247b5ce2e487d3610db5ce3e3d8cc882c38ab8db.png" alt="\beta"/> and <img class="math" src="../../../../_images/math/14399e7612a4ec9fbdf2368f565afb3cdffc083d.png" alt="\beta_{0}"/>. As a matter of convention, among all the possible representations of the hyperplane, the one chosen is</p>
<div class="math">
<p><img src="../../../../_images/math/50330811d77296fa9bd8aa038422d519060d1b3c.png" alt="|\beta_{0} + \beta^{T} x| = 1"/></p>
</div><p>where <img class="math" src="../../../../_images/math/275d1cfd2234a22c171bcf9ee37dd451fffd5e1b.png" alt="x"/> symbolizes the training examples closest to the hyperplane. In general, the training examples that are closest to the hyperplane are called <strong>support vectors</strong>. This representation is known as the <strong>canonical hyperplane</strong>.</p>
<p>Now, we use the result of geometry that gives the distance between a point <img class="math" src="../../../../_images/math/275d1cfd2234a22c171bcf9ee37dd451fffd5e1b.png" alt="x"/> and a hyperplane <img class="math" src="../../../../_images/math/5867f52d316e23790d4fa840a1eddcfb2ece7422.png" alt="(\beta, \beta_{0})"/>:</p>
<div class="math">
<p><img src="../../../../_images/math/f2b9c053ba8184375c0b2eeae044d251ccb8d4c8.png" alt="\mathrm{distance} = \frac{|\beta_{0} + \beta^{T} x|}{||\beta||}."/></p>
</div><p>In particular, for the canonical hyperplane, the numerator is equal to one and the distance to the support vectors is</p>
<div class="math">
<p><img src="../../../../_images/math/d68b36f3383af7a0c4d865e6b41c8c73465c84b1.png" alt="\mathrm{distance}_{\text{ support vectors}} = \frac{|\beta_{0} + \beta^{T} x|}{||\beta||} = \frac{1}{||\beta||}."/></p>
</div><p>Recall that the margin introduced in the previous section, here denoted as <img class="math" src="../../../../_images/math/336950fdbecc1771997c5eb48994a4b7056f3b81.png" alt="M"/>, is twice the distance to the closest examples:</p>
<div class="math">
<p><img src="../../../../_images/math/771036d81fdb0bf77451869a9aeb9f9e328c2960.png" alt="M = \frac{2}{||\beta||}"/></p>
</div><p>Finally, the problem of maximizing <img class="math" src="../../../../_images/math/336950fdbecc1771997c5eb48994a4b7056f3b81.png" alt="M"/> is equivalent to the problem of minimizing a function <img class="math" src="../../../../_images/math/e9fed0b45442fccb38079cd62bb7a6951ab97b40.png" alt="L(\beta)"/> subject to some constraints. The constraints model the requirement for the hyperplane to classify correctly all the training examples <img class="math" src="../../../../_images/math/f45ea88ff5c83aa33b3af69ae2c100017788d5c7.png" alt="x_{i}"/>. Formally,</p>
<div class="math">
<p><img src="../../../../_images/math/f3ed6d036621a0014dc06517073d237013151f89.png" alt="\min_{\beta, \beta_{0}} L(\beta) = \frac{1}{2}||\beta||^{2} \text{ subject to } y_{i}(\beta^{T} x_{i} + \beta_{0}) \geq 1 \text{ } \forall i,"/></p>
</div><p>where <img class="math" src="../../../../_images/math/4cf82d555b86931efc92042d5ae2e44676175d19.png" alt="y_{i}"/> represents each of the labels of the training examples.</p>
<p>This is a problem of Lagrangian optimization that can be solved using Lagrange multipliers to obtain the weight vector <img class="math" src="../../../../_images/math/247b5ce2e487d3610db5ce3e3d8cc882c38ab8db.png" alt="\beta"/> and the bias <img class="math" src="../../../../_images/math/14399e7612a4ec9fbdf2368f565afb3cdffc083d.png" alt="\beta_{0}"/> of the optimal hyperplane.</p>
</div>
<div class="section" id="source-code">
<h2>Source Code<a class="headerlink" href="#source-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">#include</span> <span class="cpf">&lt;opencv2/core/core.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;opencv2/highgui/highgui.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;opencv2/ml/ml.hpp&gt;</span><span class="cp"></span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">cv</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// Data for visual representation</span>
    <span class="kt">int</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">512</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">512</span><span class="p">;</span>
    <span class="n">Mat</span> <span class="n">image</span> <span class="o">=</span> <span class="n">Mat</span><span class="o">::</span><span class="n">zeros</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">CV_8UC3</span><span class="p">);</span>

    <span class="c1">// Set up training data</span>
    <span class="kt">float</span> <span class="n">labels</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">};</span>
    <span class="n">Mat</span> <span class="n">labelsMat</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">CV_32FC1</span><span class="p">,</span> <span class="n">labels</span><span class="p">);</span>

    <span class="kt">float</span> <span class="n">trainingData</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="p">{</span><span class="mi">501</span><span class="p">,</span> <span class="mi">10</span><span class="p">},</span> <span class="p">{</span><span class="mi">255</span><span class="p">,</span> <span class="mi">10</span><span class="p">},</span> <span class="p">{</span><span class="mi">501</span><span class="p">,</span> <span class="mi">255</span><span class="p">},</span> <span class="p">{</span><span class="mi">10</span><span class="p">,</span> <span class="mi">501</span><span class="p">}</span> <span class="p">};</span>
    <span class="n">Mat</span> <span class="n">trainingDataMat</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">CV_32FC1</span><span class="p">,</span> <span class="n">trainingData</span><span class="p">);</span>

    <span class="c1">// Set up SVM&#39;s parameters</span>
    <span class="n">CvSVMParams</span> <span class="n">params</span><span class="p">;</span>
    <span class="n">params</span><span class="p">.</span><span class="n">svm_type</span>    <span class="o">=</span> <span class="n">CvSVM</span><span class="o">::</span><span class="n">C_SVC</span><span class="p">;</span>
    <span class="n">params</span><span class="p">.</span><span class="n">kernel_type</span> <span class="o">=</span> <span class="n">CvSVM</span><span class="o">::</span><span class="n">LINEAR</span><span class="p">;</span>
    <span class="n">params</span><span class="p">.</span><span class="n">term_crit</span>   <span class="o">=</span> <span class="n">cvTermCriteria</span><span class="p">(</span><span class="n">CV_TERMCRIT_ITER</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">);</span>

    <span class="c1">// Train the SVM</span>
    <span class="n">CvSVM</span> <span class="n">SVM</span><span class="p">;</span>
    <span class="n">SVM</span><span class="p">.</span><span class="n">train</span><span class="p">(</span><span class="n">trainingDataMat</span><span class="p">,</span> <span class="n">labelsMat</span><span class="p">,</span> <span class="n">Mat</span><span class="p">(),</span> <span class="n">Mat</span><span class="p">(),</span> <span class="n">params</span><span class="p">);</span>

    <span class="n">Vec3b</span> <span class="n">green</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">blue</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="c1">// Show the decision regions given by the SVM</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">image</span><span class="p">.</span><span class="n">rows</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">image</span><span class="p">.</span><span class="n">cols</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Mat</span> <span class="n">sampleMat</span> <span class="o">=</span> <span class="p">(</span><span class="n">Mat_</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
            <span class="kt">float</span> <span class="n">response</span> <span class="o">=</span> <span class="n">SVM</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sampleMat</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">response</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">image</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="n">Vec3b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>  <span class="o">=</span> <span class="n">green</span><span class="p">;</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">response</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                 <span class="n">image</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="n">Vec3b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>  <span class="o">=</span> <span class="n">blue</span><span class="p">;</span>
        <span class="p">}</span>

    <span class="c1">// Show the training data</span>
    <span class="kt">int</span> <span class="n">thickness</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">lineType</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
    <span class="n">circle</span><span class="p">(</span> <span class="n">image</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="mi">501</span><span class="p">,</span>  <span class="mi">10</span><span class="p">),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">Scalar</span><span class="p">(</span>  <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">),</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">lineType</span><span class="p">);</span>
    <span class="n">circle</span><span class="p">(</span> <span class="n">image</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span>  <span class="mi">10</span><span class="p">),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">Scalar</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">lineType</span><span class="p">);</span>
    <span class="n">circle</span><span class="p">(</span> <span class="n">image</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="mi">501</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">Scalar</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">lineType</span><span class="p">);</span>
    <span class="n">circle</span><span class="p">(</span> <span class="n">image</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">501</span><span class="p">),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">Scalar</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">lineType</span><span class="p">);</span>

    <span class="c1">// Show support vectors</span>
    <span class="n">thickness</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">lineType</span>  <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">c</span>     <span class="o">=</span> <span class="n">SVM</span><span class="p">.</span><span class="n">get_support_vector_count</span><span class="p">();</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="kt">float</span><span class="o">*</span> <span class="n">v</span> <span class="o">=</span> <span class="n">SVM</span><span class="p">.</span><span class="n">get_support_vector</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="n">circle</span><span class="p">(</span> <span class="n">image</span><span class="p">,</span>  <span class="n">Point</span><span class="p">(</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>   <span class="mi">6</span><span class="p">,</span>  <span class="n">Scalar</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">lineType</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">imwrite</span><span class="p">(</span><span class="s">&quot;result.png&quot;</span><span class="p">,</span> <span class="n">image</span><span class="p">);</span>        <span class="c1">// save the image</span>

    <span class="n">imshow</span><span class="p">(</span><span class="s">&quot;SVM Simple Example&quot;</span><span class="p">,</span> <span class="n">image</span><span class="p">);</span> <span class="c1">// show it to the user</span>
    <span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="explanation">
<h2>Explanation<a class="headerlink" href="#explanation" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><strong>Set up the training data</strong></li>
</ol>
<blockquote>
<div><p>The training data of this exercise is formed by a set of labeled 2D-points that belong to one of two different classes; one of the classes consists of one point and the other of three points.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="kt">float</span> <span class="n">labels</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">};</span>
<span class="kt">float</span> <span class="n">trainingData</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{{</span><span class="mi">501</span><span class="p">,</span> <span class="mi">10</span><span class="p">},</span> <span class="p">{</span><span class="mi">255</span><span class="p">,</span> <span class="mi">10</span><span class="p">},</span> <span class="p">{</span><span class="mi">501</span><span class="p">,</span> <span class="mi">255</span><span class="p">},</span> <span class="p">{</span><span class="mi">10</span><span class="p">,</span> <span class="mi">501</span><span class="p">}};</span>
</pre></div>
</div>
<p>The function <a class="reference external" href="http://docs.opencv.org/modules/ml/doc/support_vector_machines.html#cvsvm-train">CvSVM::train</a> that will be used afterwards requires the training data to be stored as <a class="reference external" href="http://docs.opencv.org/modules/core/doc/basic_structures.html#mat">Mat</a> objects of floats. Therefore, we create these objects from the arrays defined above:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">Mat</span> <span class="nf">trainingDataMat</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">CV_32FC1</span><span class="p">,</span> <span class="n">trainingData</span><span class="p">);</span>
<span class="n">Mat</span> <span class="nf">labelsMat</span>      <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">CV_32FC1</span><span class="p">,</span> <span class="n">labels</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic" start="2">
<li><p class="first"><strong>Set up SVM&#8217;s parameters</strong></p>
<p>In this tutorial we have introduced the theory of SVMs in the most simple case, when the training examples are spread into two classes that are linearly separable. However, SVMs can be used in a wide variety of problems (e.g. problems with non-linearly separable data, a SVM using a kernel function to raise the dimensionality of the examples, etc). As a consequence of this, we have to define some parameters before training the SVM. These parameters are stored in an object of the class <a class="reference external" href="http://docs.opencv.org/modules/ml/doc/support_vector_machines.html#cvsvmparams">CvSVMParams</a> .</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">CvSVMParams</span> <span class="n">params</span><span class="p">;</span>
<span class="n">params</span><span class="p">.</span><span class="n">svm_type</span>    <span class="o">=</span> <span class="n">CvSVM</span><span class="o">::</span><span class="n">C_SVC</span><span class="p">;</span>
<span class="n">params</span><span class="p">.</span><span class="n">kernel_type</span> <span class="o">=</span> <span class="n">CvSVM</span><span class="o">::</span><span class="n">LINEAR</span><span class="p">;</span>
<span class="n">params</span><span class="p">.</span><span class="n">term_crit</span>   <span class="o">=</span> <span class="n">cvTermCriteria</span><span class="p">(</span><span class="n">CV_TERMCRIT_ITER</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">);</span>
</pre></div>
</div>
<ul>
<li><p class="first"><em>Type of SVM</em>. We choose here the type <strong>CvSVM::C_SVC</strong> that can be used for n-class classification (n <img class="math" src="../../../../_images/math/1d68cb93582bda70a78f9342048fdecdfda7324a.png" alt="\geq"/> 2). This parameter is defined in the attribute <em>CvSVMParams.svm_type</em>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The important feature of the type of SVM <strong>CvSVM::C_SVC</strong> deals with imperfect separation of classes (i.e. when the training data is non-linearly separable). This feature is not important here since the data is linearly separable and we chose this SVM type only for being the most commonly used.</p>
</div>
</li>
<li><p class="first"><em>Type of SVM kernel</em>. We have not talked about kernel functions since they are not interesting for the training data we are dealing with. Nevertheless, let&#8217;s explain briefly now the main idea behind a kernel function. It is a mapping done to the training data to improve its resemblance to a linearly separable set of data. This mapping consists of increasing the dimensionality of the data and is done efficiently using a kernel function. We choose here the type <strong>CvSVM::LINEAR</strong> which means that no mapping is done. This parameter is defined in the attribute <em>CvSVMParams.kernel_type</em>.</p>
</li>
<li><p class="first"><em>Termination criteria of the algorithm</em>. The SVM training procedure is implemented solving a constrained quadratic optimization problem in an <strong>iterative</strong> fashion. Here we specify a maximum number of iterations and a tolerance error so we allow the algorithm to finish in less number of steps even if the optimal hyperplane has not been computed yet. This parameter is defined in a structure <a class="reference external" href="http://docs.opencv.org/modules/core/doc/old_basic_structures.html#cvtermcriteria">cvTermCriteria</a>.</p>
</li>
</ul>
</li>
<li><p class="first"><strong>Train the SVM</strong></p>
<p>We call the method <a class="reference external" href="http://docs.opencv.org/modules/ml/doc/support_vector_machines.html#cvsvm-train">CvSVM::train</a> to build the SVM model.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">CvSVM</span> <span class="n">SVM</span><span class="p">;</span>
<span class="n">SVM</span><span class="p">.</span><span class="n">train</span><span class="p">(</span><span class="n">trainingDataMat</span><span class="p">,</span> <span class="n">labelsMat</span><span class="p">,</span> <span class="n">Mat</span><span class="p">(),</span> <span class="n">Mat</span><span class="p">(),</span> <span class="n">params</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Regions classified by the SVM</strong></p>
</li>
</ol>
<blockquote>
<div><p>The method <a class="reference external" href="http://docs.opencv.org/modules/ml/doc/support_vector_machines.html#cvsvm-predict">CvSVM::predict</a> is used to classify an input sample using a trained SVM. In this example we have used this method in order to color the space depending on the prediction done by the SVM. In other words, an image is traversed interpreting its pixels as points of the Cartesian plane. Each of the points is colored depending on the class predicted by the SVM; in green if it is the class with label 1 and in blue if it is the class with label -1.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">Vec3b</span> <span class="nf">green</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">blue</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">image</span><span class="p">.</span><span class="n">rows</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">image</span><span class="p">.</span><span class="n">cols</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="n">Mat</span> <span class="n">sampleMat</span> <span class="o">=</span> <span class="p">(</span><span class="n">Mat_</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">);</span>
    <span class="kt">float</span> <span class="n">response</span> <span class="o">=</span> <span class="n">SVM</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sampleMat</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">response</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
       <span class="n">image</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="n">Vec3b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>  <span class="o">=</span> <span class="n">green</span><span class="p">;</span>
    <span class="k">else</span>
    <span class="nf">if</span> <span class="p">(</span><span class="n">response</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">image</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="n">Vec3b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>  <span class="o">=</span> <span class="n">blue</span><span class="p">;</span>
    <span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic" start="5">
<li><p class="first"><strong>Support vectors</strong></p>
<p>We use here a couple of methods to obtain information about the support vectors. The method <a class="reference external" href="http://docs.opencv.org/modules/ml/doc/support_vector_machines.html#cvsvm-get-support-vector">CvSVM::get_support_vector_count</a> outputs the total number of support vectors used in the problem and with the method <a class="reference external" href="http://docs.opencv.org/modules/ml/doc/support_vector_machines.html#cvsvm-get-support-vector">CvSVM::get_support_vector</a> we obtain each of the support vectors using an index. We have used this methods here to find the training examples that are support vectors and highlight them.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="kt">int</span> <span class="n">c</span>     <span class="o">=</span> <span class="n">SVM</span><span class="p">.</span><span class="n">get_support_vector_count</span><span class="p">();</span>

<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
<span class="k">const</span> <span class="kt">float</span><span class="o">*</span> <span class="n">v</span> <span class="o">=</span> <span class="n">SVM</span><span class="p">.</span><span class="n">get_support_vector</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="c1">// get and then highlight with grayscale</span>
<span class="n">circle</span><span class="p">(</span>   <span class="n">image</span><span class="p">,</span>  <span class="n">Point</span><span class="p">(</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>   <span class="mi">6</span><span class="p">,</span>  <span class="n">Scalar</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">lineType</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<div class="enumeratevisibleitemswithsquare container">
<ul class="simple">
<li>The code opens an image and shows the training examples of both classes. The points of one class are represented with white circles and black ones are used for the other class.</li>
<li>The SVM is trained and used to classify all the pixels of the image. This results in a division of the image in a blue region and a green region. The boundary between both regions is the optimal separating hyperplane.</li>
<li>Finally the support vectors are shown using gray rings around the training examples.</li>
</ul>
</div>
<img alt="The seperated planes" class="align-center" src="../../../../_images/result.png" />
</div>
</div>


          </div>
          <div class="feedback">
              <h2>Help and Feedback</h2>
              You did not find what you were looking for?
              <ul>
                  
                  
                  
                  <li>Ask a question on the <a href="http://answers.opencv.org">Q&A forum</a>.</li>
                  <li>If you think something is missing or wrong in the documentation,
                  please file a <a href="http://code.opencv.org">bug report</a>.</li>
              </ul>
          </div>
        </div>
      </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/opencv-logo-white.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
      <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
      </p>
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction to Support Vector Machines</a><ul>
<li><a class="reference internal" href="#goal">Goal</a></li>
<li><a class="reference internal" href="#what-is-a-svm">What is a SVM?</a></li>
<li><a class="reference internal" href="#how-is-the-optimal-hyperplane-computed">How is the optimal hyperplane computed?</a></li>
<li><a class="reference internal" href="#source-code">Source Code</a></li>
<li><a class="reference internal" href="#explanation">Explanation</a></li>
<li><a class="reference internal" href="#results">Results</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../table_of_content_ml/table_of_content_ml.html"
                        title="previous chapter"><em>ml</em> module. Machine Learning</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../non_linear_svms/non_linear_svms.html"
                        title="next chapter">Support Vector Machines for Non-Linearly Separable Data</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../../_sources/doc/tutorials/ml/introduction_to_svm/introduction_to_svm.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../non_linear_svms/non_linear_svms.html" title="Support Vector Machines for Non-Linearly Separable Data"
             >next</a> |</li>
        <li class="right" >
          <a href="../table_of_content_ml/table_of_content_ml.html" title="ml module. Machine Learning"
             >previous</a> |</li>
        <li><a href="../../../../index.html">OpenCV 2.4.13.7 documentation</a> &raquo;</li>
          <li><a href="../../tutorials.html" >OpenCV Tutorials</a> &raquo;</li>
          <li><a href="../table_of_content_ml/table_of_content_ml.html" ><em>ml</em> module. Machine Learning</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011-2014, opencv dev team.
      Last updated on Jul 12, 2018.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.6.
    </div>
  </body>
</html>