<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33108845-1']);
  _gaq.push(['_setDomainName', 'opencv.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Expectation Maximization &mdash; OpenCV 2.4.13.7 documentation</title>
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2.4.13.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="OpenCV 2.4.13.7 documentation" href="../../../index.html" />
    <link rel="up" title="legacy. Deprecated stuff" href="legacy.html" />
    <link rel="next" title="Histograms" href="histograms.html" />
    <link rel="prev" title="Motion Analysis" href="motion_analysis.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="histograms.html" title="Histograms"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="motion_analysis.html" title="Motion Analysis"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../index.html">OpenCV 2.4.13.7 documentation</a> &raquo;</li>
          <li><a href="../../refman.html" >OpenCV API Reference</a> &raquo;</li>
          <li><a href="legacy.html" accesskey="U">legacy. Deprecated stuff</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
  
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="expectation-maximization">
<h1>Expectation Maximization<a class="headerlink" href="#expectation-maximization" title="Permalink to this headline">¶</a></h1>
<p>This section describes obsolete <code class="docutils literal"><span class="pre">C</span></code> interface of EM algorithm. Details of the algorithm and its <code class="docutils literal"><span class="pre">C++</span></code> interface can be found in the other section <a class="reference internal" href="../../ml/doc/expectation_maximization.html#ml-expectation-maximization"><span>Expectation Maximization</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>An example on using the Expectation Maximalization algorithm can be found at opencv_source_code/samples/cpp/em.cpp</li>
<li>(Python) An example using Expectation Maximalization for Gaussian Mixing can be found at opencv_source_code/samples/python2/gaussian_mix.py</li>
</ul>
</div>
<div class="section" id="cvemparams">
<h2>CvEMParams<a class="headerlink" href="#cvemparams" title="Permalink to this headline">¶</a></h2>
<dl class="struct">
<dt id="CvEMParams">
<em class="property">struct </em><code class="descname">CvEMParams</code><a class="headerlink" href="#CvEMParams" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Parameters of the EM algorithm. All parameters are public. You can initialize them by a constructor and then override some of them directly if you want.</p>
</div>
<div class="section" id="cvemparams-cvemparams">
<h2>CvEMParams::CvEMParams<a class="headerlink" href="#cvemparams-cvemparams" title="Permalink to this headline">¶</a></h2>
<p>The constructors</p>
<dl class="function">
<dt id="CvEMParams::CvEMParams()">
<strong>C++:</strong><code class="descname"> </code> <code class="descclassname">CvEMParams::</code><code class="descname">CvEMParams</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CvEMParams::CvEMParams()" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="CvEMParams::CvEMParams(int nclusters, int cov_mat_type, int start_step, CvTermCriteria term_crit, const CvMat* probs, const CvMat* weights, const CvMat* means, const CvMat** covs)">
<strong>C++:</strong><code class="descname"> </code> <code class="descclassname">CvEMParams::</code><code class="descname">CvEMParams</code><span class="sig-paren">(</span>int <strong>nclusters</strong>, int <strong>cov_mat_type</strong>=EM::COV_MAT_DIAGONAL, int <strong>start_step</strong>=EM::START_AUTO_STEP, CvTermCriteria <strong>term_crit</strong>=cvTermCriteria(CV_TERMCRIT_ITER+CV_TERMCRIT_EPS, 100, FLT_EPSILON), const CvMat* <strong>probs</strong>=0, const CvMat* <strong>weights</strong>=0, const CvMat* <strong>means</strong>=0, const CvMat** <strong>covs</strong>=0 <span class="sig-paren">)</span><a class="headerlink" href="#CvEMParams::CvEMParams(int nclusters, int cov_mat_type, int start_step, CvTermCriteria term_crit, const CvMat* probs, const CvMat* weights, const CvMat* means, const CvMat** covs)" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nclusters</strong> &#8211; The number of mixture components in the Gaussian mixture model. Some of EM implementation could determine the optimal number of mixtures within a specified value range, but that is not the case in ML yet.</li>
<li><strong>cov_mat_type</strong> &#8211; <p>Constraint on covariance matrices which defines type of matrices. Possible values are:</p>
<ul>
<li><strong>CvEM::COV_MAT_SPHERICAL</strong> A scaled identity matrix <img class="math" src="../../../_images/math/47b13960196d3142d101c1beda3f23cfc81d1f27.png" alt="\mu_k * I"/>. There is the only parameter <img class="math" src="../../../_images/math/3b1c90f0bf8fb4dc861c6a34989d0d1f09ff449f.png" alt="\mu_k"/> to be estimated for each matrix. The option may be used in special cases, when the constraint is relevant, or as a first step in the optimization (for example in case when the data is preprocessed with PCA). The results of such preliminary estimation may be passed again to the optimization procedure, this time with <code class="docutils literal"><span class="pre">cov_mat_type=CvEM::COV_MAT_DIAGONAL</span></code>.</li>
<li><strong>CvEM::COV_MAT_DIAGONAL</strong> A diagonal matrix with positive diagonal elements. The number of free parameters is <code class="docutils literal"><span class="pre">d</span></code> for each matrix. This is most commonly used option yielding good estimation results.</li>
<li><strong>CvEM::COV_MAT_GENERIC</strong> A symmetric positively defined matrix. The number of free parameters in each matrix is about <img class="math" src="../../../_images/math/561a31bb19319afe97ef7ab1437c346daa224bd5.png" alt="d^2/2"/>. It is not recommended to use this option, unless there is pretty accurate initial estimation of the parameters and/or a huge number of training samples.</li>
</ul>
</li>
<li><strong>start_step</strong> &#8211; <p>The start step of the EM algorithm:</p>
<ul>
<li><strong>CvEM::START_E_STEP</strong> Start with Expectation step. You need to provide means <img class="math" src="../../../_images/math/b2f299552c26575fc7c12b3fc0ef22767c34863f.png" alt="a_k"/> of mixture components to use this option. Optionally you can pass weights <img class="math" src="../../../_images/math/e1e2b0febdcaae50ac9d16c4ae02ba3a733a4120.png" alt="\pi_k"/> and covariance matrices <img class="math" src="../../../_images/math/a9d411f199bf38c959bc27a1c2018d2f62f2a952.png" alt="S_k"/> of mixture components.</li>
<li><strong>CvEM::START_M_STEP</strong> Start with Maximization step. You need to provide initial probabilities <img class="math" src="../../../_images/math/8a7b71cbaf1e17c97e2d1c0494cc026a95fae2cd.png" alt="p_{i,k}"/> to use this option.</li>
<li><strong>CvEM::START_AUTO_STEP</strong> Start with Expectation step. You need not provide any parameters because they will be estimated by the kmeans algorithm.</li>
</ul>
</li>
<li><strong>term_crit</strong> &#8211; The termination criteria of the EM algorithm. The EM algorithm can be terminated by the number of iterations <code class="docutils literal"><span class="pre">term_crit.max_iter</span></code> (number of M-steps) or when relative change of likelihood logarithm is less than <code class="docutils literal"><span class="pre">term_crit.epsilon</span></code>.</li>
<li><strong>probs</strong> &#8211; Initial probabilities <img class="math" src="../../../_images/math/8a7b71cbaf1e17c97e2d1c0494cc026a95fae2cd.png" alt="p_{i,k}"/> of sample <img class="math" src="../../../_images/math/881d48e575544c8daaa1d83893dcde5f9f7562ec.png" alt="i"/> to belong to mixture component <img class="math" src="../../../_images/math/b48130bd55bf7a75e095fda3d9f9ff1ac1b4ccef.png" alt="k"/>. It is a floating-point matrix of <img class="math" src="../../../_images/math/188e813bd3e695cb48628af26537e40e63bd7bf4.png" alt="nsamples \times nclusters"/> size. It is used and must be not NULL only when <code class="docutils literal"><span class="pre">start_step=CvEM::START_M_STEP</span></code>.</li>
<li><strong>weights</strong> &#8211; Initial weights <img class="math" src="../../../_images/math/e1e2b0febdcaae50ac9d16c4ae02ba3a733a4120.png" alt="\pi_k"/> of mixture components. It is a floating-point vector with <img class="math" src="../../../_images/math/3406e5dae35b1ada09251bdc56369faadb4948c1.png" alt="nclusters"/> elements. It is used (if not NULL) only when <code class="docutils literal"><span class="pre">start_step=CvEM::START_E_STEP</span></code>.</li>
<li><strong>means</strong> &#8211; Initial means <img class="math" src="../../../_images/math/b2f299552c26575fc7c12b3fc0ef22767c34863f.png" alt="a_k"/> of mixture components. It is a floating-point matrix of <img class="math" src="../../../_images/math/28521daabd0ccf78c093d391054be1cc86c3bfd6.png" alt="nclusters \times dims"/> size. It is used used and must be not NULL only when <code class="docutils literal"><span class="pre">start_step=CvEM::START_E_STEP</span></code>.</li>
<li><strong>covs</strong> &#8211; Initial covariance matrices <img class="math" src="../../../_images/math/a9d411f199bf38c959bc27a1c2018d2f62f2a952.png" alt="S_k"/> of mixture components. Each of covariance matrices is a valid square floating-point matrix of <img class="math" src="../../../_images/math/6592228662d6f80dcc668e76819a0eb7486a99c5.png" alt="dims \times dims"/> size. It is used (if not NULL) only when <code class="docutils literal"><span class="pre">start_step=CvEM::START_E_STEP</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The default constructor represents a rough rule-of-the-thumb:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="n">CvEMParams</span><span class="p">()</span> <span class="o">:</span> <span class="n">nclusters</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">cov_mat_type</span><span class="p">(</span><span class="mi">1</span><span class="cm">/*CvEM::COV_MAT_DIAGONAL*/</span><span class="p">),</span>
    <span class="n">start_step</span><span class="p">(</span><span class="mi">0</span><span class="cm">/*CvEM::START_AUTO_STEP*/</span><span class="p">),</span> <span class="n">probs</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">weights</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">means</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">covs</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">term_crit</span><span class="o">=</span><span class="n">cvTermCriteria</span><span class="p">(</span> <span class="n">CV_TERMCRIT_ITER</span><span class="o">+</span><span class="n">CV_TERMCRIT_EPS</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">FLT_EPSILON</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With another constructor it is possible to override a variety of parameters from a single number of mixtures (the only essential problem-dependent parameter) to initial values for the mixture parameters.</p>
</div>
<div class="section" id="cvem">
<h2>CvEM<a class="headerlink" href="#cvem" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="CvEM : public CvStatModel">
<em class="property">class </em><code class="descname">CvEM</code> : <em class="property">public</em> <code class="descname">CvStatModel</code><a class="headerlink" href="#CvEM : public CvStatModel" title="Permalink to this definition">¶</a></dt>
<dd><p>The class implements the EM algorithm as described in the beginning of the section <a class="reference internal" href="../../ml/doc/expectation_maximization.html#ml-expectation-maximization"><span>Expectation Maximization</span></a>.</p>
</dd></dl>

</div>
<div class="section" id="cvem-train">
<h2>CvEM::train<a class="headerlink" href="#cvem-train" title="Permalink to this headline">¶</a></h2>
<p>Estimates the Gaussian mixture parameters from a sample set.</p>
<dl class="function">
<dt id="bool CvEM::train(const Mat&amp; samples, const Mat&amp; sampleIdx, CvEMParams params, Mat* labels)">
<strong>C++:</strong><code class="descname"> </code>bool <code class="descclassname">CvEM::</code><code class="descname">train</code><span class="sig-paren">(</span>const Mat&amp; <strong>samples</strong>, const Mat&amp; <strong>sampleIdx</strong>=Mat(), CvEMParams <strong>params</strong>=CvEMParams(), Mat* <strong>labels</strong>=0 <span class="sig-paren">)</span><a class="headerlink" href="#bool CvEM::train(const Mat& samples, const Mat& sampleIdx, CvEMParams params, Mat* labels)" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="bool CvEM::train(const CvMat* samples, const CvMat* sampleIdx, CvEMParams params, CvMat* labels)">
<strong>C++:</strong><code class="descname"> </code>bool <code class="descclassname">CvEM::</code><code class="descname">train</code><span class="sig-paren">(</span>const CvMat* <strong>samples</strong>, const CvMat* <strong>sampleIdx</strong>=0, CvEMParams <strong>params</strong>=CvEMParams(), CvMat* <strong>labels</strong>=0 <span class="sig-paren">)</span><a class="headerlink" href="#bool CvEM::train(const CvMat* samples, const CvMat* sampleIdx, CvEMParams params, CvMat* labels)" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>samples</strong> &#8211; Samples from which the Gaussian mixture model will be estimated.</li>
<li><strong>sampleIdx</strong> &#8211; Mask of samples to use. All samples are used by default.</li>
<li><strong>params</strong> &#8211; Parameters of the EM algorithm.</li>
<li><strong>labels</strong> &#8211; The optional output &#8220;class label&#8221; for each sample: <img class="math" src="../../../_images/math/ff004b3a66a0e8aedb112900462323e08719b7bc.png" alt="\texttt{labels}_i=\texttt{arg max}_k(p_{i,k}), i=1..N"/> (indices of the most probable mixture component for each sample).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Unlike many of the ML models, EM is an unsupervised learning algorithm and it does not take responses (class labels or function values) as input. Instead, it computes the
<em>Maximum Likelihood Estimate</em> of the Gaussian mixture parameters from an input sample set, stores all the parameters inside the structure:
<img class="math" src="../../../_images/math/8a7b71cbaf1e17c97e2d1c0494cc026a95fae2cd.png" alt="p_{i,k}"/> in <code class="docutils literal"><span class="pre">probs</span></code>,
<img class="math" src="../../../_images/math/b2f299552c26575fc7c12b3fc0ef22767c34863f.png" alt="a_k"/> in <code class="docutils literal"><span class="pre">means</span></code> ,
<img class="math" src="../../../_images/math/a9d411f199bf38c959bc27a1c2018d2f62f2a952.png" alt="S_k"/> in <code class="docutils literal"><span class="pre">covs[k]</span></code>,
<img class="math" src="../../../_images/math/e1e2b0febdcaae50ac9d16c4ae02ba3a733a4120.png" alt="\pi_k"/> in <code class="docutils literal"><span class="pre">weights</span></code> , and optionally computes the output &#8220;class label&#8221; for each sample:
<img class="math" src="../../../_images/math/ff004b3a66a0e8aedb112900462323e08719b7bc.png" alt="\texttt{labels}_i=\texttt{arg max}_k(p_{i,k}), i=1..N"/> (indices of the most probable mixture component for each sample).</p>
<p>The trained model can be used further for prediction, just like any other classifier. The trained model is similar to the
<a class="reference internal" href="../../ml/doc/normal_bayes_classifier.html#CvNormalBayesClassifier : public CvStatModel" title="class CvNormalBayesClassifier : public CvStatModel"><code class="xref ocv ocv-class docutils literal"><span class="pre">CvNormalBayesClassifier</span></code></a>.</p>
<p>For an example of clustering random samples of the multi-Gaussian distribution using EM, see <code class="docutils literal"><span class="pre">em.cpp</span></code> sample in the OpenCV distribution.</p>
</div>
<div class="section" id="cvem-predict">
<h2>CvEM::predict<a class="headerlink" href="#cvem-predict" title="Permalink to this headline">¶</a></h2>
<p>Returns a mixture component index of a sample.</p>
<dl class="function">
<dt id="float CvEM::predict(const Mat&amp; sample, Mat* probs) const">
<strong>C++:</strong><code class="descname"> </code>float <code class="descclassname">CvEM::</code><code class="descname">predict</code><span class="sig-paren">(</span>const Mat&amp; <strong>sample</strong>, Mat* <strong>probs</strong>=0 <span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#float CvEM::predict(const Mat& sample, Mat* probs) const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="float CvEM::predict(const CvMat* sample, CvMat* probs) const">
<strong>C++:</strong><code class="descname"> </code>float <code class="descclassname">CvEM::</code><code class="descname">predict</code><span class="sig-paren">(</span>const CvMat* <strong>sample</strong>, CvMat* <strong>probs</strong><span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#float CvEM::predict(const CvMat* sample, CvMat* probs) const" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sample</strong> &#8211; A sample for classification.</li>
<li><strong>probs</strong> &#8211; If it is not null then the method will write posterior probabilities of each component given the sample data to this parameter.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="cvem-getnclusters">
<h2>CvEM::getNClusters<a class="headerlink" href="#cvem-getnclusters" title="Permalink to this headline">¶</a></h2>
<p>Returns the number of mixture components <img class="math" src="../../../_images/math/336950fdbecc1771997c5eb48994a4b7056f3b81.png" alt="M"/> in the Gaussian mixture model.</p>
<dl class="function">
<dt id="int CvEM::getNClusters() const">
<strong>C++:</strong><code class="descname"> </code>int <code class="descclassname">CvEM::</code><code class="descname">getNClusters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#int CvEM::getNClusters() const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="int CvEM::get_nclusters() const">
<strong>C++:</strong><code class="descname"> </code>int <code class="descclassname">CvEM::</code><code class="descname">get_nclusters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#int CvEM::get_nclusters() const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="cvem-getmeans">
<h2>CvEM::getMeans<a class="headerlink" href="#cvem-getmeans" title="Permalink to this headline">¶</a></h2>
<p>Returns mixture means <img class="math" src="../../../_images/math/b2f299552c26575fc7c12b3fc0ef22767c34863f.png" alt="a_k"/>.</p>
<dl class="function">
<dt id="Mat CvEM::getMeans() const">
<strong>C++:</strong><code class="descname"> </code>Mat <code class="descclassname">CvEM::</code><code class="descname">getMeans</code><span class="sig-paren">(</span><span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#Mat CvEM::getMeans() const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="const CvMat* CvEM::get_means() const">
<strong>C++:</strong><code class="descname"> </code>const CvMat* <code class="descclassname">CvEM::</code><code class="descname">get_means</code><span class="sig-paren">(</span><span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#const CvMat* CvEM::get_means() const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="cvem-getcovs">
<h2>CvEM::getCovs<a class="headerlink" href="#cvem-getcovs" title="Permalink to this headline">¶</a></h2>
<p>Returns mixture covariance matrices <img class="math" src="../../../_images/math/a9d411f199bf38c959bc27a1c2018d2f62f2a952.png" alt="S_k"/>.</p>
<dl class="function">
<dt id="void CvEM::getCovs(std::vector&lt;cv::Mat&gt;&amp; covs) const">
<strong>C++:</strong><code class="descname"> </code>void <code class="descclassname">CvEM::</code><code class="descname">getCovs</code><span class="sig-paren">(</span>std::vector&lt;cv::Mat&gt;&amp; <strong>covs</strong><span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#void CvEM::getCovs(std::vector<cv::Mat>& covs) const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="const CvMat** CvEM::get_covs() const">
<strong>C++:</strong><code class="descname"> </code>const CvMat** <code class="descclassname">CvEM::</code><code class="descname">get_covs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#const CvMat** CvEM::get_covs() const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="cvem-getweights">
<h2>CvEM::getWeights<a class="headerlink" href="#cvem-getweights" title="Permalink to this headline">¶</a></h2>
<p>Returns mixture weights <img class="math" src="../../../_images/math/e1e2b0febdcaae50ac9d16c4ae02ba3a733a4120.png" alt="\pi_k"/>.</p>
<dl class="function">
<dt id="Mat CvEM::getWeights() const">
<strong>C++:</strong><code class="descname"> </code>Mat <code class="descclassname">CvEM::</code><code class="descname">getWeights</code><span class="sig-paren">(</span><span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#Mat CvEM::getWeights() const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="const CvMat* CvEM::get_weights() const">
<strong>C++:</strong><code class="descname"> </code>const CvMat* <code class="descclassname">CvEM::</code><code class="descname">get_weights</code><span class="sig-paren">(</span><span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#const CvMat* CvEM::get_weights() const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="cvem-getprobs">
<h2>CvEM::getProbs<a class="headerlink" href="#cvem-getprobs" title="Permalink to this headline">¶</a></h2>
<p>Returns vectors of probabilities for each training sample.</p>
<dl class="function">
<dt id="Mat CvEM::getProbs() const">
<strong>C++:</strong><code class="descname"> </code>Mat <code class="descclassname">CvEM::</code><code class="descname">getProbs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#Mat CvEM::getProbs() const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="const CvMat* CvEM::get_probs() const">
<strong>C++:</strong><code class="descname"> </code>const CvMat* <code class="descclassname">CvEM::</code><code class="descname">get_probs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#const CvMat* CvEM::get_probs() const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>For each training sample <img class="math" src="../../../_images/math/881d48e575544c8daaa1d83893dcde5f9f7562ec.png" alt="i"/> (that have been passed to the constructor or to <a class="reference internal" href="#bool CvEM::train(const Mat&amp; samples, const Mat&amp; sampleIdx, CvEMParams params, Mat* labels)" title="bool CvEM::train(const Mat&amp; samples, const Mat&amp; sampleIdx, CvEMParams params, Mat* labels)"><code class="xref ocv ocv-func docutils literal"><span class="pre">CvEM::train()</span></code></a>) returns probabilities <img class="math" src="../../../_images/math/8a7b71cbaf1e17c97e2d1c0494cc026a95fae2cd.png" alt="p_{i,k}"/> to belong to a mixture component <img class="math" src="../../../_images/math/b48130bd55bf7a75e095fda3d9f9ff1ac1b4ccef.png" alt="k"/>.</p>
</div>
<div class="section" id="cvem-getlikelihood">
<h2>CvEM::getLikelihood<a class="headerlink" href="#cvem-getlikelihood" title="Permalink to this headline">¶</a></h2>
<p>Returns logarithm of likelihood.</p>
<dl class="function">
<dt id="double CvEM::getLikelihood() const">
<strong>C++:</strong><code class="descname"> </code>double <code class="descclassname">CvEM::</code><code class="descname">getLikelihood</code><span class="sig-paren">(</span><span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#double CvEM::getLikelihood() const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="double CvEM::get_log_likelihood() const">
<strong>C++:</strong><code class="descname"> </code>double <code class="descclassname">CvEM::</code><code class="descname">get_log_likelihood</code><span class="sig-paren">(</span><span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#double CvEM::get_log_likelihood() const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="cvem-write">
<h2>CvEM::write<a class="headerlink" href="#cvem-write" title="Permalink to this headline">¶</a></h2>
<p>Writes the trained Gaussian mixture model to the file storage.</p>
<dl class="function">
<dt id="void CvEM::write(CvFileStorage* fs, const char* name) const">
<strong>C++:</strong><code class="descname"> </code>void <code class="descclassname">CvEM::</code><code class="descname">write</code><span class="sig-paren">(</span>CvFileStorage* <strong>fs</strong>, const char* <strong>name</strong><span class="sig-paren">)</span><code class="descclassname"> const</code><a class="headerlink" href="#void CvEM::write(CvFileStorage* fs, const char* name) const" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fs</strong> &#8211; A file storage where the model will be written.</li>
<li><strong>name</strong> &#8211; A name of the file node where the model data will be written.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="cvem-read">
<h2>CvEM::read<a class="headerlink" href="#cvem-read" title="Permalink to this headline">¶</a></h2>
<p>Reads the trained Gaussian mixture model from the file storage.</p>
<dl class="function">
<dt id="void CvEM::read(CvFileStorage* fs, CvFileNode* node)">
<strong>C++:</strong><code class="descname"> </code>void <code class="descclassname">CvEM::</code><code class="descname">read</code><span class="sig-paren">(</span>CvFileStorage* <strong>fs</strong>, CvFileNode* <strong>node</strong><span class="sig-paren">)</span><a class="headerlink" href="#void CvEM::read(CvFileStorage* fs, CvFileNode* node)" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fs</strong> &#8211; A file storage with the trained model.</li>
<li><strong>node</strong> &#8211; The parent map. If it is NULL, the function searches a node with parameters in all the top-level nodes (streams), starting with the first one.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
          <div class="feedback">
              <h2>Help and Feedback</h2>
              You did not find what you were looking for?
              <ul>
                  
                  
                  
                  <li>Ask a question on the <a href="http://answers.opencv.org">Q&A forum</a>.</li>
                  <li>If you think something is missing or wrong in the documentation,
                  please file a <a href="http://code.opencv.org">bug report</a>.</li>
              </ul>
          </div>
        </div>
      </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/opencv-logo-white.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
      <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
      </p>
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Expectation Maximization</a><ul>
<li><a class="reference internal" href="#cvemparams">CvEMParams</a></li>
<li><a class="reference internal" href="#cvemparams-cvemparams">CvEMParams::CvEMParams</a></li>
<li><a class="reference internal" href="#cvem">CvEM</a></li>
<li><a class="reference internal" href="#cvem-train">CvEM::train</a></li>
<li><a class="reference internal" href="#cvem-predict">CvEM::predict</a></li>
<li><a class="reference internal" href="#cvem-getnclusters">CvEM::getNClusters</a></li>
<li><a class="reference internal" href="#cvem-getmeans">CvEM::getMeans</a></li>
<li><a class="reference internal" href="#cvem-getcovs">CvEM::getCovs</a></li>
<li><a class="reference internal" href="#cvem-getweights">CvEM::getWeights</a></li>
<li><a class="reference internal" href="#cvem-getprobs">CvEM::getProbs</a></li>
<li><a class="reference internal" href="#cvem-getlikelihood">CvEM::getLikelihood</a></li>
<li><a class="reference internal" href="#cvem-write">CvEM::write</a></li>
<li><a class="reference internal" href="#cvem-read">CvEM::read</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="motion_analysis.html"
                        title="previous chapter">Motion Analysis</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="histograms.html"
                        title="next chapter">Histograms</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/modules/legacy/doc/expectation_maximization.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="histograms.html" title="Histograms"
             >next</a> |</li>
        <li class="right" >
          <a href="motion_analysis.html" title="Motion Analysis"
             >previous</a> |</li>
        <li><a href="../../../index.html">OpenCV 2.4.13.7 documentation</a> &raquo;</li>
          <li><a href="../../refman.html" >OpenCV API Reference</a> &raquo;</li>
          <li><a href="legacy.html" >legacy. Deprecated stuff</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011-2014, opencv dev team.
      Last updated on Jul 12, 2018.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.6.
    </div>
  </body>
</html>